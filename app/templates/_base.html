<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Solar Fleet Monitor</title>
    <link rel="icon" href="{{ url_for('static', filename='MZ Solar(transparent).png') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gray-100 text-gray-900">
    <nav class="bg-white shadow sticky top-0 z-40">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex items-center justify-between h-20">
                <!-- Left: Logo + Brand -->
                <a href="{{ url_for('main.index') }}" class="flex items-center gap-3">
                    <img src="{{ url_for('static', filename='MZ Solar(transparent).png') }}"
                        alt="Company Logo" class="h-20 w-auto"/>
                </a>

                <!-- Center: Nav links -->
                {% macro navlink(label, endpoint, url) -%}
                    {# active ako endpoint odgovara #}
                    {% set is_active = request.endpoint and request.endpoint.startswith(endpoint) %}
                    <a href="{{ url }}"
                        class="px-3 py-2 rounded-md text-sm font-medium
                            {{ 'bg-blue-600 text-white' if is_active else 'text-gray-700 hover:bg-gray-100' }}">
                        {{ label }}    
                    </a>
                {%- endmacro %}

                <div class="hidden md:flex items-center gap-1">
                    {{ navlink('Dashboard', 'main.', url_for('main.index')) }}
                    {{ navlink('Sites',     'sites.', url_for('sites.list_sites')) }}
                    {{ navlink('Meters',    'meters.', url_for('meters.list_meters')) }}
                    {{ navlink('Uploads',   'uploads.', url_for('uploads.index')) }}
                    {{ navlink('Reports',   'reports.', url_for('reports.index')) }}
                    {{ navlink('Alarms',    'alarms.', url_for('alarms.list_alarms')) }}
                    {{ navlink('PPA/Billing',    'ppa.', url_for('ppa.contracts')) }}
                    {{ navlink('Tickets', 'tickets.', url_for('tickets.list_tickets')) }} 
                </div>

                <!-- Right: user -->
                <div class="flex items-center gap-2">
                    {% if current_user.is_authenticated %}
                        <span class="hidden sm:inline text-sm text-gray-600">Hi, {{ current_user.username }}</span>
                        <a href="{{ url_for('auth.logout') }}"
                            class="px-3 py-2 rounded-md text-sm bg-gray-200 hover:bg-gray-300">Logout</a>
                    {% else %}
                        <a href="{{ url_for('auth.login') }}"
                            class="px-3 py-2 rounded-md text-sm bg-blue-600 text-white">Login</a>
                        
                        <a href="{{ url_for('auth.register') }}"
                            class="px-3 py-2 rounded-md text-sm bg-blue-600 text-white">Register</a>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Mobile links -->
        <div class="md:hidden border-t">
            <div class="px-4 py-2 flex flex-wrap gap-2">
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('main.index') }}">Dashboard</a>
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('sites.list_sites') }}">Sites</a>
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('meters.list_meters') }}">Meters</a>
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('uploads.index') }}">Uploads</a>
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('reports.index') }}">Reports</a>
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('alarms.list_alarms') }}">Alarms</a>
                <a class="px-3 py-2 rounded-md bg-gray-100" href="{{ url_for('ppa.contracts') }}">PPA/Billing</a>
                <a href="{{ url_for('tickets.list_tickets') }}">Tickets</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mb-4">
                    {% for category, message in messages %}
                        <div class="p-3 rounded mb-2 {{ 'bg-green-100' if category=='success' else 'bg-red-100' }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </main>

    <!-- (obiÄno pri dnu body-ja) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>


</body>
</html>